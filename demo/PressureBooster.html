<!DOCTYPE html>

<html>
<head>
<title>AQS Pump Selection</title>

	<link rel="stylesheet" type="text/css" href="css/styles.css">
<script type="text/javascript">

window.onload = function onLoad()
{  var urlParam = new URLSearchParams(window.location.search);
	var id = urlParam.get('id');
};

//Used to find index for Select Lists
function indexMatchingText(ele, text) {
	for (var i=0; i<ele.length;i++) {
			if (ele[i].text === text){
					return i;
			}
	}
	return undefined;
}

function backClick()
{
	var flow = document.getElementById('flowRate').value;
	var fUnits = document.getElementById('flowSel').text;
	var head = document.getElementById('tHead').value;
	var hUnits = document.getElementById('headUnits').text;
	var id = document.getElementById('id').value;
	var url = "ProductPage.html?id=" + id + "&flow=" + flow + "&fUnits=" + fUnits + "&head=" + head + "&hUnits=" + hUnits;
	window.location = url;
}

function calCulate() {

	var fl = document.getElementById('flowRate').value;
	var sH = document.getElementById('sHeight').value;
	var dH = document.getElementById('dHeight').value;
	var dp = document.getElementById('dPres').value;
	var pd = document.getElementById('pDiam').value;
	var ln = document.getElementById('len').value;

	var sel = document.getElementById('flowSel');
	var cFl = fl * (sel.options[1].value / sel.options[sel.selectedIndex].value );

	sel = document.getElementById('shSel');
	cSH = sH * (sel.options[0].value / sel.options[sel.selectedIndex].value);

	sel = document.getElementById('dhSel');
	cDH = dH * (sel.options[0].value / sel.options[sel.selectedIndex].value);

	sel = document.getElementById('dpSel');
	cDP = dp * (sel.options[0].value / sel.options[sel.selectedIndex].value);
	var pdm = pd / 1000;
	var Vel = (4/1000)*cFl/(3.141592 * Math.pow(pdm,2));
	var statH = (cDH - cSH);

	var nHazen = document.getElementById('pMat').options[document.getElementById('pMat').selectedIndex].value;
	var fricH = 0;
	fricH = getFricHead(cFl, nHazen, pd, Vel)*ln+cDP;
	var totH = statH+fricH;

	document.getElementById('vel').value = Vel.toPrecision(4);
	document.getElementById('sHead').value = statH.toPrecision(4);
	document.getElementById('fHead').value = fricH.toPrecision(4);
	document.getElementById('tHead').value = totH.toPrecision(4);

}

function getTotH(statH, fricH)
{
	return (statH + fricH);
}

function getFricHead(flow, nHazen, nD, nV)
{
	var visc = 1;
	var nFL = 0;
	var nRey = (nV * (nD/1000) * 1000000 / visc);

	if(nD <= 0)
	{
		alert("Please Enter a Positive, Non-Zero Diameter.")
		return 0;
	}
	else if(+nRey <= 2000)
	{
		var nF = 64/+nRey;
		nFL = (nF * Math.pow(nV,2))/ ((nD/1000) * 2 * 9.81);
	}
	else {
		if (nHazen > 1)
		{
				nFL = (0.002083 * Math.pow((100/nHazen),1.85) * Math.pow((flow/0.0631),1.85))/(Math.pow((nD/25.4),4.8655));
		}
		else
		{
			alert("Failure");
		}
	}


	return nFL;
}

</script>


</head><body style="width: 100vw; height: 100vh;">
<div class="bodyMain">
<div id= "logoDiv" class="logo" onclick="window.location.href='index.html'"><img src="./Logo/logoMain.png" border="0" alt="Company Logo" style="padding: 3vh 0 0 25vw; width: 50vw;"></div>
	<form>
		<div class="header">
		<h2 id="head1">Pressure Booster Tool</h2>
		</div>
		<div>
			<table>
				<tr>
					<td>
						<label class="lbls">Number of Bedrooms</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox" id="flowRate"></input>
          </td>
        </tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Number of Bathrooms</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox" id="sHeight"></input>
          </td>
        </tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Number of Floors</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox"  id="dHeight"></input>
          </td>
        </tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Inlet Pressure</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox" id="dPres"></input>
          </td>
          <td>
            <select class="unitsBox" id="dpSel">
							<option value="1">m</option>
							<option value="9.9804">kPa</option>
							<option value="0.09804">bar</option>
							<option value="3.28">ft</option>
							<option value="1.42197">psi</option>
							<option value="2.89516">inHg</option>
							<option value="75.53709">Torr</option>
            </select>
          </td>
        </tr>	<tr>
  					<td>
  						<label class="lbls">Discharge Pressure</label>
  					</td>
            <td> <div class="spacingDiv1"> </td>
            <td>
              <input type="number" class="txtBox" id="dPres"></input>
            </td>
            <td>
              <select class="unitsBox" id="dpSel">
  							<option value="1">m</option>
  							<option value="9.98041">kPa</option>
  							<option value="0.098041">bar</option>
  							<option value="3.28">ft</option>
  							<option value="1.42197">psi</option>
  							<option value="2.89516">inHg</option>
  							<option value="75.53709">Torr</option>
              </select>
            </td>
          </tr>
				<!---->
			</table>
		</div>
		<br/>
		<div align="center">
			<input type ="button" value="Calculate" class="button" id="calcBtn" onclick="calCulate()"></input>
		</div>
		<br/>
		<div>
			<table width="100%">
				<tr>
					<td>
						<label class="lbls">Flow Rate</label>
					</td>
          <td> <div class="spacingDiv2"> </td>
					<td>
						<input id="vel" readonly class="txtBox" value="0"></input>
					</td>
					<td>
            <div class="spacingDiv2">
						<label class ="lbl">mÂ³/h</label>
          </div>
					</td>
				</tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Friction Loss</label>
					</td>
          <td> <div class="spacingDiv2"> </td>
					<td>
						<input id="sHead" readonly class="txtBox" value="0"></input>
					</td>
					<td>
            <div class="spacingDiv2">
						<label class ="lbl">m</label>
          </div>
					</td>
				</tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Dynamic Head</label>
					</td>
          <td> <div class="spacingDiv2"> </td>
					<td>
						<input id="fHead" readonly class="txtBox" value="0"></input>
					</td>
					<td>
            <div class="spacingDiv2">
						<label class ="lbl">m</label>
          </div>
					</td>
				</tr>
			</table>
		</div>
		<br/>
			<div align="center">
				<input type="button" value="Save and Return" class="button" id="saveBtn" onclick="backClick()"></input>
			</div>
			<label id="id" style="visibility:hidden;"></label>	<!-- 	 -->
	</form>
</div>
</body>
</html>
