<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pressure Booster Calculations</title>
    <!--link async rel="stylesheet" href="./css/style.css"-->
    <link async rel="stylesheet" href="./css/styles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,600,300italic,600italic" rel="stylesheet" type="text/css">
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#000000">
    <link rel="icon" sizes="144x144" href="./Logo/logo-144.png">
     <script src="./js/data1.js"></script>
      <script src="./js/indexjs.js"></script>

window.onload = function onLoad()
{  var urlParam = new URLSearchParams(window.location.search);
	var id = urlParam.get('id');
  document.getElementById('id').value=id;
};

function backClick()
{
	var CFlow = document.getElementById('flow').value;
	var Dhead = document.getElementById('dynamicHead').value;;
	var id = document.getElementById('id').value;
	var url = "ProductPage.html?id=" + id + "&flow=" + CFlow + "&fUnits=m³/h&head=" + Dhead + "&hUnits=m";
	window.location = url;
}

function calculateFlow(bed,bath)
{
  var baths = [1,1.5,2,3,4,5,6];
  var beds = [2,3,4,5,6];
  var flowTable = [
                    [ 1.4 , 1.8 , 2.3 , 2.7 , 3.2 , 3.6 , 4.1],
                    [ 1.8 , 2.3 , 2.7 , 3.2 , 3.6 , 4.1 , 4.5],
                    [ 2.3 , 2.7 , 3.2 , 3.6 , 4.1 , 4.5 , 5.0],
                    [ null, 3.0 , 3.4 , 3.9 , 4.3 , 4.8 , 5.2],
                    [ null, 3.2 , 3.6 , 4.1 , 4.5 , 5.0 , 5.5]];
  var bedIndex = beds.findIndex(function(bd) {return bd == bed;});
  var bathIndex = baths.findIndex(function(bd) {return bd == bath;});
  var flow = flowTable[bedIndex][bathIndex];
  return flow;
}

function calculateFrictionLoss(floor,bath, tflow)
{
    var baths = [1,1.5,2,3,4,5,6];
    var pLengthTable =  [8 , 10 , 12 , 15 , 18 , 21 , 24];
    var bathIndex = baths.findIndex(function(bd) {return bd == bath;});
    var pLength = pLengthTable[bathIndex] + (5*(floor-1));
    var nFlow = tflow/3600;

    var nHazen = 100;
    var pDiam = 25/1000; //25mm to M
    var fHead = (10.67 * Math.pow(nFlow,1.852))/(Math.pow(nHazen,1.852) * Math.pow(pDiam, 4.8704));
    //var fHead = (0.002083 * Math.pow((100/nHazen),1.85) * Math.pow(((tflow/3.6)/0.0631),1.85))/(Math.pow((pDiam/25.4),4.8655));// - Other Eqaution?
		//nFL = (0.002083 * Math.pow((100/nHazen),1.85) * Math.pow((nFlow/0.0631),1.85))/(Math.pow((pDiam/25.4),4.8655));
    fricHead = fHead * pLength;
    return fricHead;

}

function calculations() {

	var nBed = document.getElementById('nBedrooms').value;
	var nBath = document.getElementById('nBathrooms').value;
	var nFloor = document.getElementById('nFloors').value;
	var iPressure = document.getElementById('inPressure').value;
	var dPressure = document.getElementById('outPressure').value;

  var cFlow = calculateFlow(nBed,nBath);
  document.getElementById('flow').value = cFlow;

	var sel = document.getElementById('ipSel');
	var cIP = iPressure * (sel.options[0].value / sel.options[sel.selectedIndex].value);

	sel = document.getElementById('opSel');
	var cDP = dPressure * (sel.options[0].value / sel.options[sel.selectedIndex].value);

	fricH = calculateFrictionLoss(nFloor, nBath, cFlow);

  var dynHead = (cDP - cIP) + fricH + (nFloor * 3.5);

	document.getElementById('frictionHead').value = fricH.toPrecision(4);
	document.getElementById('dynamicHead').value = dynHead.toPrecision(4);

}


</script>


</head>
<body>
<div class="bodyMain">
<div id= "logoDiv" class="logo" onclick="window.location.href='index.html'"><img src="./Logo/logoMain.png" border="0" alt="Company Logo" style="padding: 3vh 0 0 25vw; width: 50vw;"></div>
	<form>
		<div class="header">
		<h2 id="head1">Pressure Booster Tool</h2>
		</div>
		<div>
			<table>
				<tr>
					<td>
						<label class="lbls">Number of Bedrooms</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox" id="nBedrooms"></input>
          </td>
        </tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Number of Bathrooms</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox" id="nBathrooms"></input>
          </td>
        </tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Number of Floors</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox"  id="nFloors"></input>
          </td>
        </tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Inlet Pressure</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
          <td>
            <input type="number" class="txtBox" id="inPressure" selectedIndex="2"></input>
          </td>
          <td>
            <select class="unitsBox" id="ipSel">
							<option value="1">m</option>
							<option value="9.9804">kPa</option>
							<option value="0.09804">bar</option>
							<option value="3.28">ft</option>
							<option value="1.42197">psi</option>
							<option value="2.89516">inHg</option>
							<option value="75.53709">Torr</option>
            </select>
          </td>
        </tr>	<tr>
  					<td>
  						<label class="lbls">Discharge Pressure</label>
  					</td>
            <td> <div class="spacingDiv1"> </td>
            <td>
              <input type="number" class="txtBox" id="outPressure"></input>
            </td>
            <td>
              <select class="unitsBox" id="opSel" selectedIndex="1">
  							<option value="1">m</option>
  							<option value="9.98041">kPa</option>
  							<option value="0.098041">bar</option>
  							<option value="3.28">ft</option>
  							<option value="1.42197">psi</option>
  							<option value="2.89516">inHg</option>
  							<option value="75.53709">Torr</option>
              </select>
            </td>
          </tr>
				<!---->
			</table>
		</div>
		<br/>
		<div class="btnDiv" align="center">
			<input type ="button" value="Calculate" class="button" id="calcBtn" onclick="calculations()"></input>
		</div>
		<br/>
		<div>
			<table width="100%">
				<tr>
					<td>
						<label class="lbls">Flow Rate</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
					<td>
						<input id="flow" readonly class="txtBox" value="0"></input>
					</td>
					<td>
            <div class="spacingDiv2">
						<label class ="lbl">m³/h</label>
          </div>
					</td>
				</tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Friction Loss</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
					<td>
						<input id="frictionHead" readonly class="txtBox" value="0"></input>
					</td>
					<td>
            <div class="spacingDiv2">
						<label class ="lbl">m</label>
          </div>
					</td>
				</tr>
				<!---->
				<tr>
					<td>
						<label class="lbls">Total Dynamic Head</label>
					</td>
          <td> <div class="spacingDiv1"> </td>
					<td>
						<input id="dynamicHead" readonly class="txtBox" value="0"></input>
					</td>
					<td>
            <div class="spacingDiv2">
						<label class ="lbl">m</label>
          </div>
					</td>
				</tr>
			</table>
		</div>
		<br/>
			<div class="btnDiv" align="center">
				<input type="button" value="Save and Return" class="button" id="saveBtn" onclick="backClick()"></input>
			</div>
			<label id="id" style="visibility:hidden;"></label>	<!-- 	 -->
	</form>
</div>
</body>
</html>
